<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SRGB Interactive Effect Builder</title>
    <meta property="og:title" content="SRGB Interactive Effect Builder">
    <meta property="og:description" content="A tool for creating and sharing visual effects for SignalRGB.">
    <meta property="og:type" content="website">
    <meta property="og:image" content="https://joseamirandavelez.github.io/EffectBuilder/logo.png">
    <meta name="twitter:card" content="summary_large_image">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script type="module" src="firebase.js"></script>
    <link rel="stylesheet" href="styles.css">

    <template id="initial-config">
        <meta title="Text Test" />
        <meta description="Built with Effect Builder (https://joseamirandavelez.github.io/EffectBuilder/), by Jose Miranda" />
        <meta publisher="Jose Miranda" />
        <meta property="enableAnimation" label="Enable Animation" type="boolean" default="true" />
        <meta property="enableSound" label="Enable Sound" type="boolean" default="true" />

        <meta property="obj1_shape" label="Small Clock: Shape" type="combobox" values="rectangle,circle,ring,text" default="text" />
        <meta property="obj1_x" label="Small Clock: X Position" type="number" min="0" max="320" default="0" />
        <meta property="obj1_y" label="Small Clock: Y Position" type="number" min="0" max="200" default="35" />
        <meta property="obj1_width" label="Small Clock: Width/Outer Diameter" type="number" min="2" max="320" default="130" />
        <meta property="obj1_height" label="Small Clock: Height" type="number" min="2" max="200" default="17" />
        <meta property="obj1_rotation" label="Small Clock: Rotation" type="number" min="-360" max="360" default="0" />
        <meta property="obj1_innerDiameter" label="Small Clock: Inner Diameter" type="number" min="1" max="318" default="50" />
        <meta property="obj1_numberOfSegments" label="Small Clock: Segments" type="number" min="1" max="50" default="8" />
        <meta property="obj1_angularWidth" label="Small Clock: Segment Angle" type="number" min="1" max="360" default="20" />
        <meta property="obj1_rotationSpeed" label="Small Clock: Rotation Speed" type="number" min="-100" max="100" default="0" />
        <meta property="obj1_animationSpeed" label="Small Clock: Animation Speed" type="number" min="1" max="50" default="50" />
        <meta property="obj1_animationMode" label="Small Clock: Animation Mode" type="combobox" values="loop,bounce,bounce-reversed,bounce-random" default="bounce-random" />
        <meta property="obj1_scrollDir" label="Small Clock: Scroll Direction" type="combobox" values="right,left,up,down" default="right" />
        <meta property="obj1_gradType" label="Small Clock: Fill Type" type="combobox" values="solid,linear,radial,alternating,random" default="linear" />
        <meta property="obj1_useSharpGradient" label="Small Clock: Use Sharp Gradient" type="boolean" default="true" />
        <meta property="obj1_gradientStop" label="Small Clock: Gradient Stop %" type="number" min="0" max="100" default="72" />
        <meta property="obj1_gradColor1" label="Small Clock: Color 1" type="color" default="#00ff00" />
        <meta property="obj1_gradColor2" label="Small Clock: Color 2" type="color" default="#d400ff" />
        <meta property="obj1_cycleColors" label="Small Clock: Cycle Colors" type="boolean" default="false" />
        <meta property="obj1_cycleSpeed" label="Small Clock: Color Cycle Speed" type="number" min="1" max="10" default="10" />
        <meta property="obj1_numberOfRows" label="Small Clock: Number of Rows" type="number" min="1" max="100" default="2" />
        <meta property="obj1_numberOfColumns" label="Small Clock: Number of Columns" type="number" min="1" max="100" default="1" />
        <meta property="obj1_phaseOffset" label="Small Clock: Phase Offset" type="number" min="0" max="100" default="100" />
        <meta property="obj1_text" label="Small Clock: Text" type="textfield" default="Jose Miranda" />
        <meta property="obj1_fontSize" label="Small Clock: Font Size" type="number" min="2" max="100" default="42" />
        <meta property="obj1_textAlign" label="Small Clock: Justification" type="combobox" values="left,center,right" default="center" />
        <meta property="obj1_pixelFont" label="Small Clock: Pixel Font Style" type="combobox" values="small,large" default="small" />
        <meta property="obj1_textAnimation" label="Small Clock: Text Animation" type="combobox" values="none,marquee,typewriter,wave" default="none" />
        <meta property="obj1_textAnimationSpeed" label="Small Clock: Animation Speed" type="number" min="1" max="100" default="10" />
        <meta property="obj1_showTime" label="Small Clock: Show Current Time" type="boolean" default="true" />
        <meta property="obj1_showDate" label="Small Clock: Show Current Date" type="boolean" default="false" />
        <meta property="obj1_autoWidth" label="Small Clock: Auto-Width" type="boolean" default="true" />

        <meta property="obj2_shape" label="Large Text: Shape" type="combobox" values="rectangle,circle,ring,text" default="text" />
        <meta property="obj2_x" label="Large Text: X Position" type="number" min="0" max="320" default="-3" />
        <meta property="obj2_y" label="Large Text: Y Position" type="number" min="0" max="200" default="0" />
        <meta property="obj2_width" label="Large Text: Width/Outer Diameter" type="number" min="2" max="320" default="237" />
        <meta property="obj2_height" label="Large Text: Height" type="number" min="2" max="200" default="30" />
        <meta property="obj2_rotation" label="Large Text: Rotation" type="number" min="-360" max="360" default="0" />
        <meta property="obj2_innerDiameter" label="Large Text: Inner Diameter" type="number" min="1" max="318" default="50" />
        <meta property="obj2_numberOfSegments" label="Large Text: Segments" type="number" min="1" max="50" default="8" />
        <meta property="obj2_angularWidth" label="Large Text: Segment Angle" type="number" min="1" max="360" default="20" />
        <meta property="obj2_rotationSpeed" label="Large Text: Rotation Speed" type="number" min="-100" max="100" default="0" />
        <meta property="obj2_animationSpeed" label="Large Text: Animation Speed" type="number" min="1" max="50" default="50" />
        <meta property="obj2_animationMode" label="Large Text: Animation Mode" type="combobox" values="loop,bounce,bounce-reversed,bounce-random" default="bounce-random" />
        <meta property="obj2_scrollDir" label="Large Text: Scroll Direction" type="combobox" values="right,left,up,down" default="right" />
        <meta property="obj2_gradType" label="Large Text: Fill Type" type="combobox" values="solid,linear,radial,alternating,random" default="linear" />
        <meta property="obj2_useSharpGradient" label="Large Text: Use Sharp Gradient" type="boolean" default="true" />
        <meta property="obj2_gradientStop" label="Large Text: Gradient Stop %" type="number" min="0" max="100" default="72" />
        <meta property="obj2_gradColor1" label="Large Text: Color 1" type="color" default="#00ff00" />
        <meta property="obj2_gradColor2" label="Large Text: Color 2" type="color" default="#d400ff" />
        <meta property="obj2_cycleColors" label="Large Text: Cycle Colors" type="boolean" default="false" />
        <meta property="obj2_cycleSpeed" label="Large Text: Color Cycle Speed" type="number" min="1" max="10" default="10" />
        <meta property="obj2_numberOfRows" label="Large Text: Number of Rows" type="number" min="1" max="100" default="2" />
        <meta property="obj2_numberOfColumns" label="Large Text: Number of Columns" type="number" min="1" max="100" default="1" />
        <meta property="obj2_phaseOffset" label="Large Text: Phase Offset" type="number" min="0" max="100" default="100" />
        <meta property="obj2_text" label="Large Text: Text" type="textfield" default="Interactive Effect Builder" />
        <meta property="obj2_fontSize" label="Large Text: Font Size" type="number" min="2" max="100" default="60" />
        <meta property="obj2_textAlign" label="Large Text: Justification" type="combobox" values="left,center,right" default="left" />
        <meta property="obj2_pixelFont" label="Large Text: Pixel Font Style" type="combobox" values="small,large" default="large" />
        <meta property="obj2_textAnimation" label="Large Text: Text Animation" type="combobox" values="none,marquee,typewriter,wave" default="marquee" />
        <meta property="obj2_textAnimationSpeed" label="Large Text: Animation Speed" type="number" min="1" max="100" default="29" />
        <meta property="obj2_showTime" label="Large Text: Show Current Time" type="boolean" default="false" />
        <meta property="obj2_showDate" label="Large Text: Show Current Date" type="boolean" default="false" />
        <meta property="obj2_autoWidth" label="Large Text: Auto-Width" type="boolean" default="false" />

        <meta property="obj3_shape" label="Matrix: Shape" type="combobox" values="rectangle,circle,ring,text" default="rectangle" />
        <meta property="obj3_x" label="Matrix: X Position" type="number" min="0" max="320" default="0" />
        <meta property="obj3_y" label="Matrix: Y Position" type="number" min="0" max="200" default="57" />
        <meta property="obj3_width" label="Matrix: Width/Outer Diameter" type="number" min="2" max="320" default="181" />
        <meta property="obj3_height" label="Matrix: Height" type="number" min="2" max="200" default="143" />
        <meta property="obj3_rotation" label="Matrix: Rotation" type="number" min="-360" max="360" default="0" />
        <meta property="obj3_innerDiameter" label="Matrix: Inner Diameter" type="number" min="1" max="318" default="50" />
        <meta property="obj3_numberOfSegments" label="Matrix: Segments" type="number" min="1" max="50" default="12" />
        <meta property="obj3_angularWidth" label="Matrix: Segment Angle" type="number" min="1" max="360" default="20" />
        <meta property="obj3_rotationSpeed" label="Matrix: Rotation Speed" type="number" min="-100" max="100" default="0" />
        <meta property="obj3_animationSpeed" label="Matrix: Animation Speed" type="number" min="1" max="50" default="10" />
        <meta property="obj3_animationMode" label="Matrix: Animation Mode" type="combobox" values="loop,bounce,bounce-reversed,bounce-random" default="loop" />
        <meta property="obj3_scrollDir" label="Matrix: Scroll Direction" type="combobox" values="right,left,up,down" default="right" />
        <meta property="obj3_gradType" label="Matrix: Fill Type" type="combobox" values="solid,linear,radial,alternating,random" default="random" />
        <meta property="obj3_useSharpGradient" label="Matrix: Use Sharp Gradient" type="boolean" default="false" />
        <meta property="obj3_gradientStop" label="Matrix: Gradient Stop %" type="number" min="0" max="100" default="50" />
        <meta property="obj3_gradColor1" label="Matrix: Color 1" type="color" default="#00ff00" />
        <meta property="obj3_gradColor2" label="Matrix: Color 2" type="color" default="#d400ff" />
        <meta property="obj3_cycleColors" label="Matrix: Cycle Colors" type="boolean" default="false" />
        <meta property="obj3_cycleSpeed" label="Matrix: Color Cycle Speed" type="number" min="1" max="10" default="10" />
        <meta property="obj3_numberOfRows" label="Matrix: Number of Rows" type="number" min="1" max="100" default="16" />
        <meta property="obj3_numberOfColumns" label="Matrix: Number of Columns" type="number" min="1" max="100" default="16" />
        <meta property="obj3_phaseOffset" label="Matrix: Phase Offset" type="number" min="0" max="100" default="10" />
        <meta property="obj3_text" label="Matrix: Text" type="textfield" default="" />
        <meta property="obj3_fontSize" label="Matrix: Font Size" type="number" min="2" max="100" default="15" />
        <meta property="obj3_textAlign" label="Matrix: Justification" type="combobox" values="left,center,right" default="center" />
        <meta property="obj3_pixelFont" label="Matrix: Pixel Font Style" type="combobox" values="small,large" default="small" />
        <meta property="obj3_textAnimation" label="Matrix: Text Animation" type="combobox" values="none,marquee,typewriter,wave" default="none" />
        <meta property="obj3_textAnimationSpeed" label="Matrix: Animation Speed" type="number" min="1" max="100" default="10" />
        <meta property="obj3_showTime" label="Matrix: Show Current Time" type="boolean" default="false" />
        <meta property="obj3_showDate" label="Matrix: Show Current Date" type="boolean" default="false" />
        <meta property="obj3_autoWidth" label="Matrix: Auto-Width" type="boolean" default="true" />
    </template>
</head>

<script async src="https://www.googletagmanager.com/gtag/js?id=G-WS7MGSDJSB"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-WS7MGSDJSB');
</script>

<body class="d-flex flex-column vh-100">
    <nav class="navbar navbar-expand-lg bg-body-tertiary">
        <div class="container-fluid">
            <a class="navbar-brand" href="./">SRGB Interactive Effect Builder</a>

            <div class="ms-auto d-flex align-items-center">

                <div class="btn-group me-3" role="group" aria-label="Project management actions">
                    <button class="btn btn-outline-secondary" id="new-ws-btn" data-bs-toggle="tooltip" title="New Workspace"><i class="bi bi-file-earmark-plus me-1"></i> New</button>
                    <button class="btn btn-outline-primary" id="save-ws-btn" data-bs-toggle="tooltip" title="Save current workspace to the cloud" disabled><i class="bi bi-cloud-arrow-up me-1"></i> Save</button>
                    <button class="btn btn-outline-secondary" id="load-ws-btn" data-bs-toggle="offcanvas" data-bs-target="#gallery-offcanvas" aria-controls="gallery-offcanvas" data-bs-toggle="tooltip" title="Load one of your saved projects" disabled><i class="bi bi-folder2-open me-1"></i> Open</button>
                    <button class="btn btn-outline-warning" id="browse-btn" data-bs-toggle="offcanvas" data-bs-target="#gallery-offcanvas" aria-controls="gallery-offcanvas"><i class="bi bi-view-list me-1"></i> Community Gallery</button>
                    <button class="btn btn-outline-info" id="import-btn" data-bs-toggle="modal" data-bs-target="#import-meta-modal"><i class="bi bi-box-arrow-in-down me-1"></i> Import</button>
                </div>

                <div class="btn-group me-3" role="group" aria-label="Sharing and exporting actions">
                    <button class="btn btn-outline-info" id="share-btn" title="Get a shareable link to this effect" disabled><i class="bi bi-share me-1"></i> Share</button>
                    <button class="btn btn-outline-success" id="export-btn" data-bs-toggle="tooltip" title="Download complete HTML file"><i class="bi bi-download me-1"></i> Export</button>
                </div>

                <div class="btn-group" role="group" aria-label="Help and settings">
                    <button class="btn btn-outline-secondary" id="help-btn" data-bs-toggle="modal" data-bs-target="#help-modal" title="Help"><i class="bi bi-question-circle"></i></button>
                    <button class="btn btn-outline-secondary" id="about-btn" data-bs-toggle="modal" data-bs-target="#about-modal" title="About"><i class="bi bi-info-circle"></i></button>
                    <a class="btn btn-outline-secondary" id="contact-btn" href="https://github.com/joseamirandavelez/EffectBuilder/issues/new/choose" target="_blank" rel="noopener" title="Report Bug / Request Feature on GitHub">
                        <i class="bi bi-github"></i>
                    </a>
                    <button class="btn btn-outline-secondary" type="button" id="theme-switcher-btn" title="Change Theme">
                        <i class="bi" id="theme-icon"></i>
                    </button>
                </div>

                <div class="ms-3">
                    <button class="btn btn-outline-success" id="login-btn"><i class="bi bi-google me-2"></i>Sign In</button>

                    <div class="btn-group d-none" id="user-session-group" role="group">
                        <span class="btn btn-outline-secondary d-flex align-items-center disabled" style="pointer-events: none;">
                            <img id="user-photo" class="rounded-circle me-2" style="width: 24px; height: 24px;" alt="User profile photo">
                            <span id="user-display"></span>
                        </span>
                        <button class="btn btn-outline-danger" id="logout-btn" title="Sign Out"><i class="bi bi-box-arrow-right"></i></button>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div class="container-fluid flex-grow-1 overflow-hidden p-0">
        <div class="h-100" id="main-split">
            <div id="left-panel" class="h-100 p-3 border-end bg-body-tertiary" style="overflow: auto;">
                <div class="h-100 d-flex flex-column">
                    <div class="flex-grow-1 overflow-auto pe-2">
                        <h4 class="text-body-emphasis">Controls</h4>
                        <form id="controls-form"></form>
                    </div>
                    <div class="mt-3">
                        <button class="btn btn-success w-100" id="add-object-btn" data-bs-toggle="tooltip" title="Add a new default object to the scene"><i class="bi bi-plus-circle"></i> Add New
                            Object</button>
                    </div>
                </div>
            </div>

            <div id="right-panel" class="d-flex flex-column h-100">
                <div id="toolbar" class="bg-body-tertiary p-2 rounded d-flex flex-wrap">
                    <div class="btn-group btn-group-sm me-2 mb-1" role="group" aria-label="History actions">
                        <button class="btn btn-secondary" id="undo-btn" data-bs-toggle="tooltip" title="Undo (Ctrl+Z)" disabled><i class="bi bi-arrow-counterclockwise"></i></button>
                        <button class="btn btn-secondary" id="redo-btn" data-bs-toggle="tooltip" title="Redo (Ctrl+Y)" disabled><i class="bi bi-arrow-clockwise"></i></button>
                    </div>
                    <div class="btn-group btn-group-sm me-2 mb-1" role="group">
                        <button type="button" class="btn btn-secondary" id="copy-props-btn" data-bs-toggle="tooltip" title="Copy Properties"><i class="bi bi-clipboard-plus"></i></button>
                        <button type="button" class="btn btn-secondary" id="paste-props-btn" data-bs-toggle="tooltip" title="Paste Properties" disabled><i class="bi bi-clipboard-check"></i></button>
                    </div>
                    <div class="btn-group btn-group-sm me-2 mb-1" role="group">
                        <button type="button" class="btn btn-secondary" data-action="align-screen-left" data-bs-toggle="tooltip" title="Align Left to Screen"><i class="bi bi-align-start"></i></button>
                        <button type="button" class="btn btn-secondary" data-action="align-screen-h-center" data-bs-toggle="tooltip" title="Align Horizontal Center to Screen"><i class="bi bi-align-center"></i></button>
                        <button type="button" class="btn btn-secondary" data-action="align-screen-right" data-bs-toggle="tooltip" title="Align Right to Screen"><i class="bi bi-align-end"></i></button>
                    </div>
                    <div class="btn-group btn-group-sm me-2 mb-1" role="group">
                        <button type="button" class="btn btn-secondary" data-action="align-screen-top" data-bs-toggle="tooltip" title="Align Top to Screen"><i class="bi bi-align-top"></i></button>
                        <button type="button" class="btn btn-secondary" data-action="align-screen-v-center" data-bs-toggle="tooltip" title="Align Vertical Center to Screen"><i class="bi bi-align-middle"></i></button>
                        <button type="button" class="btn btn-secondary" data-action="align-screen-bottom" data-bs-toggle="tooltip" title="Align Bottom to Screen"><i class="bi bi-align-bottom"></i></button>
                    </div>
                    <div class="btn-group btn-group-sm me-2 mb-1" role="group">
                        <button type="button" class="btn btn-secondary" data-action="match-width" data-bs-toggle="tooltip" title="Match Width of First Selected"><i class="bi bi-arrows-expand-vertical"></i> W</button>
                        <button type="button" class="btn btn-secondary" data-action="match-height" data-bs-toggle="tooltip" title="Match Height of First Selected"><i class="bi bi-arrows-expand"></i> H</button>
                        <button type="button" class="btn btn-secondary" data-action="match-both" data-bs-toggle="tooltip" title="Match Size of First Selected"><i class="bi bi-fullscreen"></i></button>
                        <button type="button" class="btn btn-secondary" data-action="fit-canvas" data-bs-toggle="tooltip" title="Fit to Canvas"><i class="bi bi-arrows-fullscreen"></i></button>
                    </div>
                    <div class="btn-group btn-group-sm me-2 mb-1" role="group">
                        <button type="button" class="btn btn-secondary" id="constrain-btn" data-bs-toggle="tooltip" title="Snap to Canvas"><i class="bi bi-magnet-fill"></i></button>
                        <button type="button" class="btn btn-secondary" id="match-text-size-btn" data-action="match-text-size" data-bs-toggle="tooltip" title="Match Text Size to Cell Height" disabled><i class="bi bi-fonts"></i> <i class="bi bi-grid-3x3"></i></button>
                        <button id="startAudioBtn" class="btn btn-primary">Start Listening</button>
                    </div>

                </div>
                <div id="right-panel-top" class="d-flex flex-column" style="overflow: auto; min-height: 0;">
                    <div id="canvas-container" class="mx-auto border border-secondary">
                        <canvas id="signalCanvas"></canvas>
                    </div>
                </div>
                <div class="ms-auto ps-3 text-body-secondary d-flex align-items-center">
                    <i class="bi bi-crosshair me-2"></i>
                    <span id="coords-display" class="font-monospace" style="min-width: 100px;">---, ---</span>
                </div>
                <div id="right-panel-bottom" class="output-panel d-flex flex-column p-3 border-top bg-body-tertiary">
                    <h5 class="text-body-emphasis mb-2">Generated Script Header</h5>

                    <div class="d-flex flex-grow-1">
                        <textarea id="output-script" class="form-control flex-grow-1" readonly></textarea>
                        <button class="btn btn-primary ms-2" id="copy-btn" ...>
                            <i class="bi bi-clipboard"></i>
                        </button>
                    </div>
                </div>

            </div>
        </div>

        <div class="toast-container position-fixed bottom-0 end-0 p-3" style="z-index: 99999">
            <div id="app-toast" class="toast border-0" role="alert" aria-live="assertive" aria-atomic="true" data-bs-delay="5000" style="width: 350px; font-size: 1.1rem;">
                <div id="app-toast-header" class="toast-header text-white d-flex align-items-center">
                    <i id="app-toast-icon" class="bi me-2"></i>
                    <strong class="me-auto" id="app-toast-title">Notification</strong>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast" aria-label="Close"></button>
                </div>
                <div class="toast-body bg-dark" id="app-toast-body">
                </div>
            </div>
        </div>

        <div class="modal fade" id="load-project-modal" tabindex="-1" aria-labelledby="loadProjectModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="loadProjectModalLabel">Load Project</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <p>Select a project to load. This will overwrite your current workspace.</p>
                        <ul class="list-group" id="load-project-list"></ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade" id="save-project-modal" tabindex="-1" aria-labelledby="saveProjectModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="saveProjectModalLabel">Save Project</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="mb-3">
                            <label for="save-project-name-input" class="form-label">Project Name:</label>
                            <input type="text" class="form-control" id="save-project-name-input" placeholder="Enter a name for your project...">
                        </div>
                        <hr>
                        <p>Existing Projects:</p>
                        <ul class="list-group" id="save-project-existing-list">
                        </ul>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-primary" id="confirm-save-btn">Save Project</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade" id="notification-modal" tabindex="-1" aria-labelledby="notificationModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="notificationModalLabel">Success</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body" id="notification-modal-body">
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" data-bs-dismiss="modal">OK</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade" id="confirm-overwrite-modal" tabindex="-1" aria-labelledby="confirmOverwriteModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="confirmOverwriteModalLabel">Confirm Overwrite</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body" id="confirm-overwrite-modal-body">
                        A project with this name already exists. Do you want to overwrite it?
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-danger" id="confirm-overwrite-btn">Overwrite</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="help-modal" tabindex="-1" aria-labelledby="helpModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered modal-lg modal-dialog-scrollable">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="helpModalLabel"><i class="bi bi-question-circle me-2"></i>How to Use the Effect Builder</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <p>Welcome to the SRGB Interactive Effect Builder! This guide explains the main features to help you create stunning visual effects.</p>

                        <div class="ratio ratio-16x9 mb-4">
                            <iframe src="https://www.youtube.com/embed/KSasPw0HScc?si=vCThireMBH0jnnHj" title="SRGB Interactive Effect Builder" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
                        </div>

                        <h6 class="text-info">The Controls Panel (Left)</h6>
                        <p>This is where you manage all the objects and global settings for your effect.</p>
                        <ul>
                            <li><strong>General Settings:</strong> This panel contains properties for your entire effect.
                                <ul>
                                    <li><strong>Title & Description:</strong> Sets the metadata for your effect file.</li>
                                    <li><strong>Minimize Properties for Export:</strong> When checked, this reduces the number of editable controls in the final exported file, writing most values as fixed constants in the script. This can improve performance in SignalRGB.</li>
                                </ul>
                            </li>
                            <li><strong>Add New Object:</strong> Use the green button at the bottom to add a new shape to the canvas.</li>
                            <li><strong>Object Panels:</strong> Each object gets its own collapsible panel. You can perform several actions here:
                                <ul>
                                    <li><strong>Rename:</strong> Click the object's name (e.g., "Object 1") to edit it.</li>
                                    <li><strong>Reorder:</strong> Click and drag the <i class="bi bi-grip-vertical"></i> icon to change the rendering order (layers). Objects at the top are drawn first (in the back).</li>
                                    <li><strong>Lock/Unlock:</strong> Use the <i class="bi bi-unlock-fill"></i> / <i class="bi bi-lock-fill"></i> button to prevent an object from being accidentally moved or resized on the canvas.</li>
                                    <li><strong>Duplicate/Delete:</strong> Use the menu button (<i class="bi bi-list"></i>) to access options for duplicating or deleting an object.</li>
                                </ul>
                            </li>
                            <li><strong class="text-warning">Shape-Specific Settings:</strong> The real power of the builder lies in its specialized shapes. When you change an object's <strong>Shape</strong> property, different settings will appear.
                                <ul>
                                    <li><strong>Text:</strong> Offers several <strong>Text Animation</strong> modes, including <em>Marquee</em> (scrolling), <em>Typewriter</em>, and <em>Wave</em>. You can also override the text field to show the current time or date.</li>
                                    <li><strong>Rectangle (Grid):</strong> By increasing the <strong>Number of Rows</strong> or <strong>Columns</strong>, you can turn a rectangle into a grid. Use the <strong>Phase Offset</strong> property to create cascading animations across the grid cells.</li>
                                    <li><strong>Fire &amp; FireRadial:</strong> These are particle emitters. Their color is not controlled by a special property; instead, they use the standard <strong>Fill Type</strong> controls. For example, set the Fill Type to <em>Random</em> to get random-colored flames, or set it to <em>Rainbow</em> for a rainbow fire effect.</li>
                                    <li><strong>Oscilloscope:</strong> This shape has a unique <strong>Display Mode</strong> called <em>Seismic</em>. This mode creates expanding, rotating, phased waves. The <strong>Phase Offset</strong> property is key here, as it controls the rotational difference between each wave, allowing for complex vortex effects.</li>
                                    <li><strong>Pixel Art:</strong> This shape allows you to render custom art by providing a 2D array (a list of lists) in the <strong>Pixel Art Data</strong> field. Each number in the array corresponds to a pixel's opacity (from 0.0 for transparent to 1.0 for fully opaque). This shape supports all standard fill types (Linear, Radial, Rainbow, etc.), which are applied across the entire object, with the data array acting as an alpha mask. You can use the <a href="https://pixelart.nolliergb.com/" target="_blank" rel="noopener noreferrer">Pixel Art Generator</a> to create and export data for this shape.</li>
                                </ul>
                            </li>
                        </ul>

                        <h6 class="text-info mt-4">The Canvas (Center)</h6>
                        <p>This is your visual workspace where you can directly manipulate objects.</p>
                        <ul>
                            <li><strong>Select:</strong> Click an object to select it. Hold <kbd>Shift</kbd> or <kbd>Ctrl</kbd> while clicking to select multiple objects. Clicking on an empty area will deselect everything.</li>
                            <li><strong>Manipulate:</strong> With an object selected, you can:
                                <ul>
                                    <li><strong>Drag</strong> to move it.</li>
                                    <li>Drag the square handles on its bounding box to <strong>resize</strong> it.</li>
                                    <li>Drag the circular handle at the top to <strong>rotate</strong> it.</li>
                                </ul>
                            </li>
                            <li><strong>Snapping:</strong> Objects will automatically snap to the edges and centerlines of the canvas, as well as to other objects, to help with precise alignment.</li>
                            <li><strong>Keyboard Shortcuts:</strong>
                                <ul>
                                    <li><kbd>Arrow Keys</kbd>: Nudge selected objects by a small amount.</li>
                                    <li><kbd>Shift</kbd> + <kbd>Arrow Keys</kbd>: Move selected objects in larger steps.</li>
                                    <li><kbd>Delete</kbd> / <kbd>Backspace</kbd>: Delete all selected objects.</li>
                                    <li><kbd>Ctrl</kbd>+<kbd>Z</kbd>: Undo the last action.</li>
                                    <li><kbd>Ctrl</kbd>+<kbd>Y</kbd>: Redo the last undone action.</li>
                                </ul>
                            </li>
                        </ul>

                        <h6 class="text-info mt-4">The Canvas Toolbar (Above the Canvas)</h6>
                        <p>This toolbar provides quick access to alignment and property management tools for selected objects.</p>
                        <ul>
                            <li><strong>Copy/Paste Properties:</strong> Use <i class="bi bi-clipboard-plus"></i> to copy properties from the first selected object and <i class="bi bi-clipboard-check"></i> to paste them onto other selected objects.</li>
                            <li><strong>Alignment:</strong> Align objects to the screen's edges or center.</li>
                            <li><strong>Matching:</strong> Match the width, height, or both dimensions of all selected objects to the dimensions of the *first* object that was selected.</li>
                        </ul>

                        <h6 class="text-info mt-4">The Main Toolbar (Top)</h6>
                        <p>This toolbar contains actions for project management, sharing, and exporting. Most cloud-based actions require you to be signed in.</p>
                        <ul class="list-unstyled">
                            <li><strong class="text-primary-emphasis"><i class="bi bi-cloud-arrow-up me-1"></i> Save:</strong> Saves your current workspace to your personal cloud storage.</li>
                            <li><strong class="text-secondary-emphasis"><i class="bi bi-folder2-open me-1"></i> Open:</strong> Opens a side panel showing all the effects you have saved to the cloud.</li>
                            <li><strong class="text-warning-emphasis"><i class="bi bi-view-list me-1"></i> Community Gallery:</strong> Browse public effects created by all users.</li>
                            <li><strong class="text-info-emphasis"><i class="bi bi-share me-1"></i> Share:</strong> After saving, this button provides a unique, shareable URL for your effect that anyone can view.</li>
                            <li><strong class="text-success-emphasis"><i class="bi bi-download me-1"></i> Export:</strong> Prepares and downloads your effect as a `.zip` file, ready for use in SignalRGB.</li>
                            <li><strong class="text-secondary-emphasis"><i class="bi bi-github me-1"></i> Feedback:</strong> Opens the project's GitHub page where you can report a bug or request a new feature.</li>
                            <li><strong class="text-secondary-emphasis"><i class="bi bi-moon-stars-fill"></i> Theme:</strong> Cycles through Light, Dark, and Auto theme modes.</li>
                        </ul>

                        <h6 class="text-info mt-4">How to Install the Effect in SignalRGB</h6>
                        <ul class="list-unstyled">
                            <li>1. Click the <strong><i class="bi bi-download me-1"></i> Export</strong> button.</li>
                            <li>2. From the options that appear, click <strong>Download .zip File</strong>.</li>
                            <li>3. Find the downloaded `.zip` file and extract its contents into your SignalRGB effects folder, which is typically located at:<br><code>Documents\WhirlwindFX\Effects</code></li>
                            <li>4. For better organization, it is recommended to place the effect files inside a new subfolder (e.g., <code>Effects\My Custom Effects</code>).</li>
                            <li>5. Restart the SignalRGB application. Your new effect will now appear in the effects list.</li>
                        </ul>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Got it!</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="about-modal" tabindex="-1" aria-labelledby="aboutModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="aboutModalLabel"><i class="bi bi-info-circle me-2"></i>About This Tool</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <h6>SRGB Interactive Effect Builder</h6>
                        <img src="logo.png" class="img-fluid rounded mb-3" alt="A screenshot of the Interactive Effect Builder UI, showing a complex lighting effect being designed on a canvas with control panels on the side.">
                        <p>This tool is designed to help developers create, share, and customize complex visual effects for <a href="https://signalrgb.com/" target="_blank" rel="noopener noreferrer">SignalRGB</a>. It provides a simple graphical interface for building effects and can save them to the cloud, share them with others via a link, and export them as standalone files for use with the <a href="https://github.com/joseamirandavelez/EffectClass" target="_blank" rel="noopener">EffectClass</a> template.</p>

                        <p class="small text-body-secondary mt-4">
                            <strong>Disclaimer:</strong> This tool is an independent project and is not affiliated with, endorsed by, or in any way officially connected with the <a href="https://signalrgb.com/" target="_blank" rel="noopener noreferrer">SignalRGB</a> software or its respective owners.
                        </p>
                        <div class="small text-body-secondary mt-4">
                            <strong>Acknowledgements:</strong> This website uses the following open-source libraries:
                            <ul>
                                <li><a href="https://getbootstrap.com/" target="_blank" rel="noopener">Bootstrap</a></li>
                                <li><a href="https://icons.getbootstrap.com/" target="_blank" rel="noopener">Bootstrap Icons</a></li>
                                <li><a href="https://github.com/SortableJS/Sortable" target="_blank" rel="noopener">SortableJS</a></li>
                                <li><a href="https://stuk.github.io/jszip/" target="_blank" rel="noopener">JSZip</a></li>
                                <li><a href="https://split.js.org/" target="_blank" rel="noopener">Split.js</a></li>
                            </ul>
                        </div>
                        <hr>

                        <div class="d-flex justify-content-between align-items-center">
                            <p class="mb-0"><strong>Developer:</strong> Jose Miranda</p>
                            <a href="#" data-bs-toggle="modal" data-bs-target="#terms-modal">Terms of Usage</a>
                        </div>
                    </div>
                    <div class="modal-footer justify-content-between">
                        <span class="small text-body-secondary" id="last-updated-span">
                        </span>
                        <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="terms-modal" tabindex="-1" aria-labelledby="termsModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="termsModalLabel"><i class="bi bi-file-text me-2"></i>Terms of Usage</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <p>By using this Interactive Effect Builder (the "Tool"), you agree to the following terms:</p>

                        <h6 class="mt-4">1. No Warranty</h6>
                        <p>This Tool is provided "as-is", without any warranties of any kind, express or implied. The
                            developer makes no guarantees regarding its functionality, reliability, or suitability for any
                            particular purpose.</p>

                        <h6 class="mt-4">2. Limitation of Liability</h6>
                        <p>In no event shall the developer be liable for any claim, damages, or other liability arising from
                            the use of, or inability to use, the Tool.</p>

                        <h6 class="mt-4">3. User Responsibility</h6>
                        <p>You are solely responsible for the effects you create and their use. It is your responsibility to
                            ensure they comply with the terms of service of any platform or application they are used with,
                            including SignalRGB.</p>

                        <h6 class="mt-4">4. Content Disclaimer</h6>
                        <p>The developer is not responsible for any content, including effects, created or shared by users of this Tool. Some user-generated effects may be inappropriate or unsuitable for certain audiences. Use caution when sharing or loading effects from others.</p>

                        <h6 class="mt-4">5. License</h6>
                        <p>This Tool is free to use, modify, and distribute. Attribution is appreciated but not required.
                        </p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" id="accept-terms2-btn" data-bs-dismiss="modal">I Accept</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="import-meta-modal" tabindex="-1" aria-labelledby="importMetaModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="importMetaModalLabel"><i class="bi bi-code-slash me-2"></i>Import from Meta Tags</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <p>Paste the full block of <strong>&lt;meta&gt;</strong> tags from an old effect file below. This will overwrite your current workspace.</p>
                        </p>
                        <textarea class="form-control font-monospace" id="import-textarea" rows="10" placeholder="<meta title=... />&#10;<meta description=... />&#10;..."></textarea>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-primary" id="confirm-import-btn">Import Effect</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="offcanvas offcanvas-end" tabindex="-1" id="gallery-offcanvas" aria-labelledby="galleryOffcanvasLabel" style="width: 700px;">
            <div class="offcanvas-header">
                <h5 class="offcanvas-title" id="galleryOffcanvasLabel"><i class="bi bi-view-list me-2"></i>Community Gallery</h5>
                <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
            </div>
            <div class="offcanvas-body">
                <p>Select an effect to load into your workspace. <a href="gallery.html">View full gallery page <i class="bi bi-box-arrow-up-right"></i></a></p>
                <ul class="list-group" id="gallery-project-list">
                </ul>
            </div>
        </div>

        <div class="modal fade" id="share-modal" tabindex="-1" aria-labelledby="shareModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="shareModalLabel"><i class="bi bi-share-fill me-2"></i>Share Your Effect</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <p>Anyone with this link can view and load your effect.</p>
                        <div class="input-group">
                            <input type="text" class="form-control" id="share-link-input" readonly>
                            <button class="btn btn-primary" type="button" id="copy-share-link-btn">
                                <i class="bi bi-clipboard"></i> Copy
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="export-options-modal" tabindex="-1" aria-labelledby="exportOptionsModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exportOptionsModalLabel"><i class="bi bi-box-arrow-down me-2"></i>Export Options</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <p>Your effect is ready. How would you like to export it?</p>
                    </div>
                    <div class="modal-footer justify-content-center">
                        <button type="button" class="btn btn-success" id="export-download-btn"><i class="bi bi-file-earmark-zip-fill me-2"></i>Download .zip File</button>
                        <button type="button" class="btn btn-primary" id="export-copy-btn"><i class="bi bi-clipboard-check-fill me-2"></i>Copy HTML Code</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="accept-terms-modal" tabindex="-1" aria-labelledby="acceptTermsModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="acceptTermsModalLabel"><i class="bi bi-shield-check me-2"></i>Terms of Usage</h5>
                    </div>
                    <div class="modal-body">
                        <p>By using this tool, you agree to the <a href="#" data-bs-toggle="modal" data-bs-target="#terms-modal" data-bs-dismiss="modal">Terms of Usage</a>.</p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" id="accept-terms-btn" data-bs-dismiss="modal">I Accept</button>
                    </div>
                </div>
            </div>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
        <script src="https://unpkg.com/split.js/dist/split.min.js"></script>
        <script src="main.js"></script>
</body>

</html>